# DittoFS configuration with cache tuning
# Infrastructure-only config - stores and shares configured via REST API
#
# Cache configuration in this CRD sets the WAL-backed cache for crash recovery.
# Application-level caching is configured per-share via REST API.
#
apiVersion: dittofs.dittofs.com/v1alpha1
kind: DittoServer
metadata:
  labels:
    app.kubernetes.io/name: dittofs-operator
    app.kubernetes.io/managed-by: kustomize
  name: dittoserver-with-cache
spec:
  image: marmos91c/dittofs:latest
  replicas: 1

  # Storage for server's internal volumes
  storage:
    metadataSize: "10Gi"
    contentSize: "50Gi"

  # Control plane database
  database:
    type: sqlite
    sqlite:
      path: "/data/controlplane/controlplane.db"

  # Large WAL-backed cache for performance
  cache:
    path: "/data/cache"
    size: "4GB"

  # Control plane REST API
  controlPlane:
    port: 8080

  # Metrics enabled
  metrics:
    enabled: true
    port: 9090

  # NFS server port
  nfsPort: 2049

  # Service configuration
  service:
    type: ClusterIP
