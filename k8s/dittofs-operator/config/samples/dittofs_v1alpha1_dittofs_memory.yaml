# Minimal DittoFS configuration for Phase 2 validation
# Infrastructure-only config - stores, shares, adapters managed via REST API
#
# This config:
# - Uses SQLite for control plane database (default)
# - WAL-backed cache at /data/cache
# - REST API on port 8080
# - NFS server on port 2049
#
# After deployment, configure stores, shares, and users via dittofsctl CLI.
apiVersion: dittofs.dittofs.com/v1alpha1
kind: DittoServer
metadata:
  name: dittofs-memory
  labels:
    app.kubernetes.io/name: dittofs-operator
    app.kubernetes.io/managed-by: kustomize
spec:
  image: marmos91c/dittofs:latest
  replicas: 1

  # Storage for internal server data
  storage:
    metadataSize: "1Gi"
    contentSize: "5Gi"

  # Control plane database - defaults to SQLite
  database:
    type: sqlite
    sqlite:
      path: "/data/controlplane/controlplane.db"

  # WAL-backed cache configuration
  cache:
    path: "/data/cache"
    size: "1GB"

  # Control plane REST API configuration
  controlPlane:
    port: 8080

  # Prometheus metrics (disabled by default)
  metrics:
    enabled: false
    port: 9090

  # NFS server port
  nfsPort: 2049

  # Service configuration
  service:
    type: ClusterIP
