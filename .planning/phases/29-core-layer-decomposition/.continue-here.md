---
phase: 29-core-layer-decomposition
task: pr-review-fixes
status: complete
last_updated: 2026-02-26T17:00:00Z
---

<current_state>
PR #209 (wave-3) Copilot comments: FIXED and pushed (4/4 done).
PR #211 (wave-4) Copilot comments: FIXED (10/10 done).

Both branches have fix commits.
</current_state>

<remaining_work>
None — all PR review comments addressed.
</remaining_work>

<decisions_made>
- PR #209 fixes: nil check on storeProvider, use configurable shutdownTimeout (not hard-coded)
- The AddShare rollback comment (issue 1 on #209) was already addressed with idempotency comment (commit 5424e181)
- PR #211 fixes:
  1. adapter.go: Updated IdentityMappingAdapter doc to explain runtime checks via MapIdentity error return (not type assertion)
  2. ARCHITECTURE.md: config.go → doc.go
  3. CLAUDE.md: config.go → doc.go
  4. 29-07-SUMMARY.md: config.go → doc.go
  5. STATE.md: total_phases/completed_phases 28 → 29
  6. identity.go: Clarified docstring — "maps protocol-specific auth state into protocol-neutral Identity"
  7. auth.go: Authenticate now treats ErrUnsupportedMechanism as continue signal
  8. auth.go: Providers() returns shallow copy of internal slice
  9. helpers_test.go: Added unit tests for MapStoreError/HandleStoreError (all error types, wrapped errors, HTTP responses)
  10. auth_test.go: Added unit tests for Authenticator chain (ordering, CanHandle, ErrUnsupportedMechanism fallthrough, Providers copy, concurrency, auth failure propagation)
- All commits must be GPG signed (-S flag)
- No Claude Code mentions in commits or PRs
</decisions_made>

<next_action>
1. Push fix commit
2. After wave-3 PR merges, rebase wave-4 onto updated wave-3
</next_action>
</content>
</invoke>